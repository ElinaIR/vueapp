{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { API } from '../axios-api';\nimport { mapState } from 'vuex';\nimport Navbar from '../components/Navbar.vue';\nexport default {\n  name: 'MyDecks',\n  components: {\n    Navbar\n  },\n  data() {\n    return {\n      loaded: false,\n      // base_url: 'http://127.0.0.1:8000',\n      cards: [],\n      back: false\n    };\n  },\n  computed: {\n    ...mapState(['accessToken', 'user']),\n    paginatedCard() {\n      let start = this.currentPage - 1;\n      let end = start + 1;\n      let cards = this.cards;\n      return cards.slice(start, end);\n    },\n    currentPage() {\n      return Number(this.$route.query.page || '1');\n    },\n    isNext() {\n      return this.currentPage + 1 <= this.cards.length;\n    },\n    areCards() {\n      return this.cards.length > 0;\n    }\n  },\n  created() {\n    API.get('/cards/cards').then(response => {\n      console.log(response.data);\n      let all_cards = response.data;\n      let today = new Date();\n      all_cards.forEach(c => {\n        let next = new Date(c.next_review);\n        if (this.user.id == c.user && c.original_card.deck.slug == this.$route.params.slug && next.getTime() < today.getTime()) {\n          this.cards.push(c);\n        }\n      });\n      console.log(this.cards, today);\n      this.loaded = true;\n    }).catch(err => {\n      console.log(err);\n    });\n  },\n  methods: {\n    look() {\n      this.back = !this.back;\n    },\n    no_card() {\n      let card = this.paginatedCard[0];\n      console.log(card);\n      let last = new Date();\n      let last_wrong = `${last.getFullYear()}-${last.getMonth() + 1}-${last.getDate()}`;\n      console.log(last_wrong);\n      API.patch(`/cards/cards/${card.id}/`, {\n        last_wrong: last_wrong\n      }, {\n        headers: {\n          'Authorization': `Bearer ${this.accessToken}`\n        }\n      }).then(response => {\n        console.log(response.data);\n      }).catch(err => {\n        console.log(err);\n      });\n      this.$router.push({\n        path: this.$route.path,\n        query: {\n          page: `${this.currentPage + 1}`\n        }\n      });\n    },\n    yes_card() {\n      let card = this.paginatedCard[0];\n      console.log(card);\n      let today = new Date();\n      let last_wrong = new Date(card.last_wrong);\n      let deltaDays = Math.ceil((today.getTime() - last_wrong.getTime()) / (1000 * 60 * 60 * 24));\n      deltaDays = deltaDays * 2 + 1;\n      let delta = deltaDays * (1000 * 60 * 60 * 24);\n      let next = new Date(last_wrong.getTime() + delta);\n      let next_review = `${next.getFullYear()}-${next.getMonth() + 1}-${next.getDate()}`;\n      console.log(last_wrong, deltaDays, delta, next.getMonth(), next_review);\n      this.cards.splice(this.cards.findIndex(c => c.id == card.id), 1);\n      API.patch(`/cards/cards/${card.id}/`, {\n        next_review: next_review\n      }, {\n        headers: {\n          'Authorization': `Bearer ${this.accessToken}`\n        }\n      }).then(response => {\n        console.log(response.data);\n      }).catch(err => {\n        console.log(err);\n      });\n    }\n  }\n};","map":{"version":3,"names":["API","mapState","Navbar","name","components","data","loaded","cards","back","computed","paginatedCard","start","currentPage","end","slice","Number","$route","query","page","isNext","length","areCards","created","get","then","response","console","log","all_cards","today","Date","forEach","c","next","next_review","user","id","original_card","deck","slug","params","getTime","push","catch","err","methods","look","no_card","card","last","last_wrong","getFullYear","getMonth","getDate","patch","headers","accessToken","$router","path","yes_card","deltaDays","Math","ceil","delta","splice","findIndex"],"sources":["/Users/elinaigdavletova/Documents/Интернет_программирование/GQW/frontend/vueapp/src/card_views/Review.vue"],"sourcesContent":["<template>\n    <Navbar></Navbar>\n    <div class=\"container\">\n        <div v-if=\"loaded\">\n        <div class=\"card mt-3 w-50 mx-auto\" v-for=\"c in paginatedCard\" :key=\"c.id\">\n            <div class=\"card-body\" @click=\"look\">\n                <div class=\"text-center\">\n                    <img :src=\"c.original_card.front_pic\" class=\"img-fluid\" alt=\"\" v-if=\"c.original_card.front_pic\">\n                </div>\n                <h5 class=\"card-title text-center\" v-if=\"c.original_card.front_word\">{{ c.original_card.front_word }}</h5>\n                <div v-if=\"back\">\n                    <br>\n                    <p id=\"back\" class=\"card-text text-center\">{{ c.original_card.back }}</p>\n                </div>\n            </div>\n        </div>\n        </div>\n        <div class=\"text-center my-4 fixed-bottom\" v-if=\"areCards\">\n            <button class=\"btn btn-outline-danger mx-5\" @click=\"no_card\">Не помню</button>\n            <router-link :to=\"{ path: this.$route.path, query: { page: `${this.currentPage + 1}`}}\" class=\"btn btn-outline-warning mx-5\" v-if=\"isNext\">Помню</router-link>\n            <router-link :to=\"{ path: this.$route.path, query: { page: `1` } }\" class=\"btn btn-outline-warning mx-5\" v-else>Помню</router-link>\n            <button class=\"btn btn-outline-success mx-5\" @click=\"yes_card\">Помню отлично</button>\n        </div>\n\n        <h2 v-else-if=\"loaded\" class=\"text-center m-5\">Повторение закончено!</h2>\n    </div>\n</template>\n\n<script>\nimport { API } from '../axios-api'\nimport { mapState } from 'vuex'\nimport Navbar from '../components/Navbar.vue'\n\nexport default {\n    name: 'MyDecks',\n    components: {\n        Navbar\n    },\n    data() {\n        return {\n            loaded: false,\n            // base_url: 'http://127.0.0.1:8000',\n            cards: [],\n            back: false,\n        }\n    },\n    computed: {\n        ...mapState(['accessToken', 'user']),\n        paginatedCard() {\n            let start = this.currentPage - 1\n            let end = start + 1\n            let cards = this.cards\n            return cards.slice(start, end)\n        },\n        currentPage() {\n            return Number(this.$route.query.page || '1')\n        },\n        isNext() {\n            return this.currentPage + 1 <= this.cards.length\n        },\n        areCards() {\n            return this.cards.length > 0\n        }\n    },\n    created() {\n        API.get('/cards/cards').then(response => {\n            console.log(response.data)\n            let all_cards = response.data\n            let today = new Date()\n            all_cards.forEach(c => {\n                let next = new Date(c.next_review)\n                if ((this.user.id == c.user) && (c.original_card.deck.slug == this.$route.params.slug) && (next.getTime() < today.getTime())) {\n                    this.cards.push(c)\n                }\n            })\n            console.log(this.cards, today)\n            this.loaded = true\n        }).catch(err => {\n            console.log(err)\n        })\n    },\n    methods: {\n        look() {\n            this.back = !this.back\n        },\n        no_card() {\n            let card = this.paginatedCard[0]\n            console.log(card)\n            let last = new Date()\n            let last_wrong = `${last.getFullYear()}-${last.getMonth() + 1}-${last.getDate()}`\n            console.log(last_wrong)\n            API.patch(`/cards/cards/${card.id}/`, {\n                last_wrong: last_wrong\n            }, {\n                headers: {\n                    'Authorization': `Bearer ${this.accessToken}`,\n                },\n            }).then(response => {\n                console.log(response.data)\n            }).catch(err => {\n                console.log(err)\n            })\n            this.$router.push({ path: this.$route.path, query: { page: `${this.currentPage + 1}` } })\n        },\n        yes_card() {\n            let card = this.paginatedCard[0]\n            console.log(card)\n            let today = new Date()\n            let last_wrong = new Date(card.last_wrong)\n            let deltaDays = Math.ceil((today.getTime() - last_wrong.getTime()) / (1000 * 60 * 60 * 24)) \n            deltaDays = deltaDays * 2 + 1\n            let delta = deltaDays * (1000 * 60 * 60 * 24)\n            let next = new Date(last_wrong.getTime() + delta)\n            let next_review = `${next.getFullYear()}-${next.getMonth() + 1}-${next.getDate()}`\n            console.log(last_wrong, deltaDays, delta, next.getMonth(), next_review)\n            this.cards.splice(this.cards.findIndex((c) => c.id == card.id), 1)\n            API.patch(`/cards/cards/${card.id}/`, {\n                next_review: next_review\n            }, {\n                headers: {\n                    'Authorization': `Bearer ${this.accessToken}`,\n                },\n            }).then(response => {\n                console.log(response.data)\n            }).catch(err => {\n                console.log(err)\n            })\n        }\n    }\n    \n}\n</script>\n<style lang=\"\">\n    \n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}