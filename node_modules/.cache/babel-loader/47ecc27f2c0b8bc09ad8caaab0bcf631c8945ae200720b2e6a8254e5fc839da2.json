{"ast":null,"code":"// import Vue from 'vue'\nimport { createStore } from 'vuex';\nimport { API } from './axios-api';\nexport default createStore({\n  state: {\n    // user: JSON.parse(localStorage.getItem('user')) || null,\n    accessToken: JSON.parse(localStorage.getItem('access')) || null,\n    refreshToken: JSON.parse(localStorage.getItem('refresh')) || null\n  },\n  mutations: {\n    updateStorage(state, {\n      access,\n      refresh\n    }) {\n      state.accessToken = access;\n      state.refreshToken = refresh;\n      console.log('access', state.accessToken);\n      console.log('refresh', state.refreshToken);\n    },\n    refreshToken(state, {\n      newAccess\n    }) {\n      state.accessToken = newAccess;\n      console.log('newAccess', state.accessToken);\n    },\n    destroyToken(state) {\n      state.accessToken = null;\n      state.refreshToken = null;\n      state.user = null;\n    },\n    getUser(state, user) {\n      // state.user = user\n      console.log(user);\n    }\n  },\n  getters: {\n    loggedIn(state) {\n      return state.accessToken != null;\n    }\n  },\n  actions: {\n    userLogin(context, usercredentials) {\n      API.post('/token/', {\n        username: usercredentials.username,\n        password: usercredentials.password\n      }).then(response => {\n        localStorage.setItem('access', JSON.stringify(response.data.access));\n        localStorage.setItem('refresh', JSON.stringify(response.data.refresh));\n        context.commit('updateStorage', {\n          access: response.data.access,\n          refresh: response.data.refresh\n        });\n        console.log(usercredentials.username);\n        API.get('/users', {\n          params: {\n            username: usercredentials.username\n          }\n        }).then(response => {\n          console.log(response.data);\n          let users = response.data;\n          users.forEach(u => {\n            if (u.username == usercredentials.username) {\n              var user = u;\n            }\n          });\n          console.log(user);\n          // for (let i = 0; i < arr.length; i++) {\n          //     console.log(i.username)\n          // }\n          localStorage.setItem('user', JSON.stringify(response.data));\n          context.commit('getUser', {\n            user: response.data\n          });\n        });\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    tokenRefresh(context, refreshToken) {\n      API.post('/token/refresh/', {\n        refresh: refreshToken\n      }).then(response => {\n        localStorage.setItem('access', response.data.access);\n        context.commit('refreshToken', {\n          newAccess: response.data.access\n        });\n        // context.commit('getUser')\n      }).catch(err => {\n        console.log(err);\n      });\n    },\n    userLogout(context) {\n      if (context.getters.loggedIn) {\n        localStorage.removeItem('user');\n        localStorage.removeItem('access');\n        localStorage.removeItem('refresh');\n        context.commit('destroyToken');\n      }\n    }\n  }\n});","map":{"version":3,"names":["createStore","API","state","accessToken","JSON","parse","localStorage","getItem","refreshToken","mutations","updateStorage","access","refresh","console","log","newAccess","destroyToken","user","getUser","getters","loggedIn","actions","userLogin","context","usercredentials","post","username","password","then","response","setItem","stringify","data","commit","get","params","users","forEach","u","catch","err","tokenRefresh","userLogout","removeItem"],"sources":["/Users/elinaigdavletova/Documents/Интернет_программирование/GQW/frontend/vueapp/src/store.js"],"sourcesContent":["// import Vue from 'vue'\nimport { createStore} from 'vuex'\nimport { API } from './axios-api'\n\nexport default createStore({\n    state: {\n        // user: JSON.parse(localStorage.getItem('user')) || null,\n        accessToken: JSON.parse(localStorage.getItem('access')) || null,\n        refreshToken: JSON.parse(localStorage.getItem('refresh')) || null,\n    },\n    mutations: {\n        updateStorage (state, { access, refresh }) {\n            state.accessToken = access\n            state.refreshToken = refresh\n            console.log('access', state.accessToken)\n            console.log('refresh', state.refreshToken)\n        },\n        refreshToken (state, { newAccess }) {\n            state.accessToken = newAccess\n            console.log('newAccess', state.accessToken)\n        },\n        destroyToken (state) {\n            state.accessToken = null\n            state.refreshToken = null\n            state.user = null\n        },\n        getUser (state, user) {\n            // state.user = user\n            console.log(user)\n        }\n    },\n    getters: {\n        loggedIn (state) {\n            return state.accessToken != null\n        }\n    },\n    actions: {\n        userLogin (context, usercredentials) {\n            API.post('/token/', {\n                username: usercredentials.username,\n                password: usercredentials.password\n            }).then(response => {\n                localStorage.setItem('access', JSON.stringify(response.data.access))\n                localStorage.setItem('refresh', JSON.stringify(response.data.refresh))\n                context.commit('updateStorage', { \n                    access: response.data.access, \n                    refresh: response.data.refresh \n                })\n                console.log(usercredentials.username)\n                API.get('/users', { \n                    params: { username: usercredentials.username }\n                }).then(response => {\n                    console.log(response.data)\n                    let users = response.data\n                    users.forEach(u => {\n                        if (u.username == usercredentials.username) {\n                            var user = u\n                        }\n                    })\n                    console.log(user)\n                    // for (let i = 0; i < arr.length; i++) {\n                    //     console.log(i.username)\n                    // }\n                    localStorage.setItem('user', JSON.stringify(response.data))\n                    context.commit('getUser', {\n                        user: response.data\n                    })\n                })\n            }).catch(err => {\n                console.log(err)\n            })\n        },\n        tokenRefresh (context, refreshToken) {\n            API.post('/token/refresh/', {\n                refresh: refreshToken,\n            }).then(response => {\n                localStorage.setItem('access', response.data.access)\n                context.commit('refreshToken', { newAccess: response.data.access })\n                // context.commit('getUser')\n            }).catch(err => {\n                console.log(err)\n            })\n        },\n        userLogout (context) {\n            if (context.getters.loggedIn) {\n                localStorage.removeItem('user')\n                localStorage.removeItem('access')\n                localStorage.removeItem('refresh')\n                context.commit('destroyToken')\n            }\n        }\n    }\n})"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}